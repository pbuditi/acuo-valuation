buildscript {
    repositories {
        mavenCentral()
        jcenter()
    }
    dependencies {
        classpath 'com.bmuschko:gradle-docker-plugin:3.0.0'
    }
}

allprojects {
	repositories {
		jcenter()
		mavenLocal()
		mavenCentral()		
    }	    
	group = 'com.acuo.collateral'
	version = '1.0'
}

def loadConfiguration() {
	def profile = hasProperty('profile') ? profile : 'dev'
	ext.profile = profile
	def configFile = file('config.groovy')
	def config = new ConfigSlurper(profile).parse(configFile.toURL())
	ext.config = config
}

configure (subprojects) {
	loadConfiguration()
	profile = profile //inject property into sub-project
	config = config     
}

configurations.all {
    // check for updates every build
    resolutionStrategy.cacheChangingModulesFor 0, 'seconds'
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.14'
}